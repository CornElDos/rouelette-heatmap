<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Roulette Heatmap App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .hidden {
      display: none;
    }
    /* Styles for clickable number buttons */
    .roulette-grid {
      display: grid;
      grid-gap: 5px;
      justify-content: center;
    }
    .roulette-button {
      width: 50px;
      height: 50px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      cursor: pointer;
      background-color: #f9f9f9;
    }
    .selected-numbers {
      margin: 10px 0;
    }
    table {
      border-collapse: collapse;
      margin: 10px auto;
    }
    td {
      border: 1px solid #000;
      width: 50px;
      height: 50px;
      text-align: center;
      vertical-align: middle;
      font-size: 16px;
    }
    .heatmap-cell {
      transition: background-color 0.3s;
    }
    /* Simple styling for the reset button */
    #resetNumbers {
      margin-top: 10px;
      padding: 5px 10px;
      font-size: 16px;
      cursor: pointer;
    }
    /* Styling for the line gap display */
    #lineCounterDisplay {
      margin-top: 15px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Roulette Heatmap App</h1>
  
  <!-- Step 1: Choose table type -->
  <div id="rouletteTypeSelection">
    <p>Choose table type:</p>
    <label>
      <input type="radio" name="tableType" value="european" checked> Single zero (European)
    </label>
    <label>
      <input type="radio" name="tableType" value="american"> 0/00 (American)
    </label>
    <button id="confirmType">Confirm</button>
  </div>

  <!-- Step 2: Enter the numbers that hit the table -->
  <div id="numberInputSection" class="hidden">
    <p>Click on the numbers that hit the roulette table:</p>
    <div id="numberGrid" class="roulette-grid"></div>
    <div class="selected-numbers">
      Selected numbers: <span id="selectedNumbersDisplay"></span>
    </div>
    <!-- Reset button to clear the entered numbers -->
    <button id="resetNumbers">Reset</button>
    <!-- New: Line gap display -->
    <div id="lineCounterDisplay"></div>
  </div>

  <!-- Step 3: Choose which heatmap to display -->
  <div id="heatmapOptions" class="hidden">
    <p>Choose which heatmap you want to display:</p>
    <button id="showStandardHeatmap">Show standard roulette heatmap</button>
    <button id="showRacetrackHeatmap">Show racetrack heatmap</button>
  </div>

  <!-- Heatmap display area -->
  <div id="heatmapDisplay" class="hidden">
    <!-- The heatmap layout will be rendered here -->
  </div>

  <script>
    // --- Global Variables ---
    let tableType = 'european';  // Default is European (single zero)
    let selectedNumbers = [];
    const minSpinsForHeatmap = 5; // At least 5 numbers are required to display the heatmap
    // Variable to keep track of the current heatmap layout ("standard" or "racetrack")
    let currentHeatmapLayout = null;

    // Define the 6 line groups (line bets) â€“ only numbers 1-36 are considered
    const lineGroups = [
      { name: "Line 1", numbers: ["1", "2", "3", "4", "5", "6"] },
      { name: "Line 2", numbers: ["7", "8", "9", "10", "11", "12"] },
      { name: "Line 3", numbers: ["13", "14", "15", "16", "17", "18"] },
      { name: "Line 4", numbers: ["19", "20", "21", "22", "23", "24"] },
      { name: "Line 5", numbers: ["25", "26", "27", "28", "29", "30"] },
      { name: "Line 6", numbers: ["31", "32", "33", "34", "35", "36"] }
    ];

    // Get element references
    const rouletteTypeSelectionDiv = document.getElementById('rouletteTypeSelection');
    const numberInputSectionDiv = document.getElementById('numberInputSection');
    const heatmapOptionsDiv = document.getElementById('heatmapOptions');
    const heatmapDisplayDiv = document.getElementById('heatmapDisplay');
    const selectedNumbersDisplay = document.getElementById('selectedNumbersDisplay');
    const numberGridDiv = document.getElementById('numberGrid');
    const resetButton = document.getElementById('resetNumbers');

    // --- Event Handlers ---
    document.getElementById('confirmType').addEventListener('click', function() {
      // Read the selected table type
      const radios = document.getElementsByName('tableType');
      for (let radio of radios) {
        if (radio.checked) {
          tableType = radio.value;
          break;
        }
      }
      // Hide the table type selection and show the number grid
      rouletteTypeSelectionDiv.classList.add('hidden');
      setupNumberGrid();
      numberInputSectionDiv.classList.remove('hidden');
      updateLineCounters(); // Initialize line counters
    });

    // Create the number grid (clickable buttons) based on the selected table type
    function setupNumberGrid() {
      numberGridDiv.innerHTML = '';
      let numbers = [];
      if (tableType === 'european') {
        // European: 0 and 1-36
        numbers.push('0');
        for (let i = 1; i <= 36; i++) {
          numbers.push(i.toString());
        }
      } else {
        // American: 0, 00 and 1-36
        numbers.push('0');
        numbers.push('00');
        for (let i = 1; i <= 36; i++) {
          numbers.push(i.toString());
        }
      }
      // Create a button for each number.
      numbers.forEach(num => {
        let btn = document.createElement('button');
        btn.textContent = num;
        btn.className = 'roulette-button';
        btn.dataset.number = num;
        btn.dataset.count = 0;
        btn.addEventListener('click', function() {
          // Add the number to the list regardless of how many have been entered
          selectedNumbers.push(num);
          updateSelectedNumbersDisplay();
          // Update the count on the button
          let currentCount = parseInt(btn.dataset.count);
          currentCount++;
          btn.dataset.count = currentCount;
          btn.textContent = num + (currentCount > 0 ? ' (' + currentCount + ')' : '');
          // Show heatmap options as soon as at least 5 numbers have been registered
          if (selectedNumbers.length >= minSpinsForHeatmap) {
            heatmapOptionsDiv.classList.remove('hidden');
          }
          // Update heatmap if already visible
          if (currentHeatmapLayout !== null) {
            displayHeatmap(currentHeatmapLayout);
          }
          // Update line counters each spin
          updateLineCounters();
        });
        numberGridDiv.appendChild(btn);
      });
      // Adjust grid layout (e.g., 6 columns)
      numberGridDiv.style.gridTemplateColumns = 'repeat(6, 50px)';
    }

    // Update the displayed list of selected numbers
    function updateSelectedNumbersDisplay() {
      selectedNumbersDisplay.textContent = selectedNumbers.join(', ');
    }

    // Update the line gap counters based on the spins (selectedNumbers)
    function updateLineCounters() {
      let displayHTML = "<h3>Line Gaps</h3>";
      // For each line group, determine the gap since a winning spin
      lineGroups.forEach(group => {
        let lastIndex = -1;
        for (let i = selectedNumbers.length - 1; i >= 0; i--) {
          if (group.numbers.includes(selectedNumbers[i])) {
            lastIndex = i;
            break;
          }
        }
        // If never won, gap equals total spins; otherwise, gap = spins since win
        let gap = (lastIndex === -1) ? selectedNumbers.length : (selectedNumbers.length - lastIndex - 1);
        displayHTML += `<p>${group.name}: ${gap} spin(s) since win</p>`;
      });
      document.getElementById("lineCounterDisplay").innerHTML = displayHTML;
    }

    // Return a color based on how many times a number was selected
    function getColorForCount(count) {
      if (count === 0) return '#fff';
      if (count === 1) return '#ffcccc';
      if (count === 2) return '#ff9999';
      if (count >= 3) return '#ff6666';
      return '#fff';
    }

    // Event handlers for the heatmap buttons
    document.getElementById('showStandardHeatmap').addEventListener('click', function() {
      currentHeatmapLayout = 'standard';
      displayHeatmap('standard');
    });
    document.getElementById('showRacetrackHeatmap').addEventListener('click', function() {
      currentHeatmapLayout = 'racetrack';
      displayHeatmap('racetrack');
    });

    // Calculate how many times each number was selected
    function getNumberFrequencies() {
      let frequencies = {};
      let possibleNumbers = [];
      if (tableType === 'european') {
        possibleNumbers.push('0');
        for (let i = 1; i <= 36; i++) {
          possibleNumbers.push(i.toString());
        }
      } else {
        possibleNumbers.push('0', '00');
        for (let i = 1; i <= 36; i++) {
          possibleNumbers.push(i.toString());
        }
      }
      possibleNumbers.forEach(num => frequencies[num] = 0);
      selectedNumbers.forEach(num => {
        if (frequencies[num] !== undefined) {
          frequencies[num]++;
        }
      });
      return frequencies;
    }

    // Render the heatmap based on the selected layout
    function displayHeatmap(layoutType) {
      heatmapDisplayDiv.innerHTML = '';
      heatmapDisplayDiv.classList.remove('hidden');
      const frequencies = getNumberFrequencies();

      if (layoutType === 'standard') {
        // --- Standard table layout: display as a table ---
        let table = document.createElement('table');
        if (tableType === 'european') {
          // For European table: top row with 0 spanning three columns
          let row0 = document.createElement('tr');
          let cell0 = document.createElement('td');
          cell0.colSpan = 3;
          cell0.textContent = '0';
          cell0.className = 'heatmap-cell';
          cell0.style.backgroundColor = getColorForCount(frequencies['0']);
          row0.appendChild(cell0);
          table.appendChild(row0);
          // Rows for numbers 1-36 in 12 rows of 3 columns each
          for (let i = 0; i < 12; i++) {
            let row = document.createElement('tr');
            for (let j = 0; j < 3; j++) {
              let num = (i * 3 + j + 1).toString();
              let cell = document.createElement('td');
              cell.textContent = num;
              cell.className = 'heatmap-cell';
              cell.style.backgroundColor = getColorForCount(frequencies[num]);
              row.appendChild(cell);
            }
            table.appendChild(row);
          }
        } else {
          // --- American table layout ---
          // Top row with 0 and 00
          let row0 = document.createElement('tr');
          let cell0 = document.createElement('td');
          cell0.textContent = '0';
          cell0.className = 'heatmap-cell';
          cell0.style.backgroundColor = getColorForCount(frequencies['0']);
          row0.appendChild(cell0);
          let cell00 = document.createElement('td');
          cell00.textContent = '00';
          cell00.className = 'heatmap-cell';
          cell00.style.backgroundColor = getColorForCount(frequencies['00']);
          // Center the row by setting colSpan on the second cell
          cell00.colSpan = 2;
          row0.appendChild(cell00);
          table.appendChild(row0);
          // Rows for numbers 1-36 (12 rows of 3 columns each)
          for (let i = 0; i < 12; i++) {
            let row = document.createElement('tr');
            for (let j = 0; j < 3; j++) {
              let num = (i * 3 + j + 1).toString();
              let cell = document.createElement('td');
              cell.textContent = num;
              cell.className = 'heatmap-cell';
              cell.style.backgroundColor = getColorForCount(frequencies[num]);
              row.appendChild(cell);
            }
            table.appendChild(row);
          }
        }
        heatmapDisplayDiv.appendChild(table);
      } else if (layoutType === 'racetrack') {
        // --- Racetrack layout: numbers are displayed in the order on the roulette wheel ---
        let racetrackDiv = document.createElement('div');
        racetrackDiv.style.display = 'flex';
        racetrackDiv.style.flexWrap = 'wrap';
        racetrackDiv.style.justifyContent = 'center';
        let wheelOrder = [];
        if (tableType === 'european') {
          // European roulette wheel (example order)
          wheelOrder = ['0', '32', '15', '19', '4', '21', '2', '25', '17', '34', '6', '27', '13', '36', '11', '30', '8', '23', '10', '5', '24', '16', '33', '1', '20', '14', '31', '9', '22', '18', '29', '7', '28', '12', '35', '3', '26'];
        } else {
          // American roulette wheel (example order)
          wheelOrder = ['0', '28', '9', '26', '30', '11', '7', '20', '32', '17', '5', '22', '34', '15', '3', '24', '36', '13', '1', '00', '27', '10', '25', '29', '12', '8', '19', '31', '18', '6', '21', '4', '2', '23', '35', '14', '16'];
        }
        // Create a small box for each number
        wheelOrder.forEach(num => {
          let box = document.createElement('div');
          box.textContent = num;
          box.style.width = '40px';
          box.style.height = '40px';
          box.style.display = 'flex';
          box.style.justifyContent = 'center';
          box.style.alignItems = 'center';
          box.style.margin = '2px';
          box.style.border = '1px solid #000';
          box.style.borderRadius = '4px';
          box.style.backgroundColor = getColorForCount(frequencies[num] || 0);
          racetrackDiv.appendChild(box);
        });
        heatmapDisplayDiv.appendChild(racetrackDiv);
      }
    }

    // Reset function: clears all entered numbers, resets the button counters, heatmap, and line counters
    resetButton.addEventListener('click', function() {
      // Clear the list of selected numbers
      selectedNumbers = [];
      updateSelectedNumbersDisplay();
      // Hide heatmap options if there are fewer than the minimum required numbers
      if (selectedNumbers.length < minSpinsForHeatmap) {
        heatmapOptionsDiv.classList.add('hidden');
      }
      // Reset each button in the number grid
      const buttons = numberGridDiv.getElementsByClassName('roulette-button');
      for (let btn of buttons) {
        btn.dataset.count = 0;
        btn.textContent = btn.dataset.number;
      }
      // Clear any displayed heatmap and reset current layout
      heatmapDisplayDiv.innerHTML = '';
      heatmapDisplayDiv.classList.add('hidden');
      currentHeatmapLayout = null;
      // Update line counters (will show zero gap for all lines)
      updateLineCounters();
    });
  </script>
</body>
</html>
